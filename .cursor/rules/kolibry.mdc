---
description:
Ты профессиональный Flutter разработчик. При проектировании архитектуры приложения важно учитывать несколько принципов, в том числе: SOLID, KISS, DRY. 
3. Требования к стейт-менеджменту (GetX, Hive)
Использование GetX, Hive:
GetX для более сложных случаев с многосоставными состояниями.
Изоляция зависимостей:
Не использовать зависимости из бизнес-логики (BL) напрямую во view.
Использовать GetX как посредников.
Организация кода:
Каждый GetX, Hive должен быть отдельно в папке с четкой структурой.
Четкая иерархия: Repository -> Service -> GetX -> UI.
Схема внедрения зависимостей
Repository -> Service -> Provider -> Manager
Внедрение зависимостей осуществляется согласно иерархии компонентов: нижестоящие компоненты могут инжектироваться в любые вышестоящие компоненты, но не наоборот. Это означает, что:
Repository могут инжектироваться в сервисы, провайдеры и менеджеры.
Service могут инжектироваться в провайдеры и менеджеры.
Provider могут инжектироваться только в менеджеры.
Manager не инжектируются никуда и являются конечной точкой внедрения зависимостей слоя BL.
Separation of Concerns: Каждый слой отвечает только за свою часть логики.
Testability: Обеспечение легкости тестирования через инверсию зависимостей и использование интерфейсов.
Independence from Frameworks: Бизнес-логика и модели данных должны быть независимыми от Flutter и других фреймворков.
Clear Dependency Flow: Избегать циклических зависимостей, обеспечивая строгое следование иерархии внедрения зависимостей.
Modularity: Разделение кода на мелкие, независимые модули для облегчения поддержки и масштабирования.
Consistency: Следование единым правилам и стилям кодирования по всему проекту.
Весь код проекта надо коментировать на русском языке
Запомни: учитывай мои текущие проекты и интересы. Если предлагаешь идею, покажи, как она связана с моим проектом или моей жизнью.
В приложении три роли это покупатель к которому прилетит дрон доставщик. При заказе товара заказать можно только один товар, при заказе покупатель выбераел локацию посадки дрона, что передается серверу с пометкой покупатель по адресу @http://80.90.191.66/flight/orderlocation . Далее переходит на страницу  отслежевания статуса заказа где мы с сервера получаем информацию о статусе: @http://80.90.191.66/order/sseorders/{ordersId}, после посадки дрона переходим на экран с кнопкой открытия грузового бокса дрона.
Так же имеется роль продавца. у него две страницы с товаром и с заказами. Каждый заказ он отправляет отдельно. после появления в списке заказа продавец по аналогии как и покупатель открывает карточку товара с заказом и нажимает кнопку вызвать дрон. после переходит как и покупатель на карту где указывает точку посадки дрона и после нажимает кнопку вызвать. При этом на сервер отправляется координаты уже с пометкой продавец, и переходит в окно статусов 1 там он видет два статуса: дрон вылетел и дрон прилетел, после приземления дрона открывается грузовой бокс дрона, после чего продавец нажимает отправить дрон и переходит в окно статусов на подобие как у покупателя. и отслеживает статус отправленного товара. после того как покупатель забрал товар открыв грузовой бокс у продавца появляется сообщение на 3 - 4 секунды что товар доставлен. и после открывается домашняя страница и заказ из списка пропадает.
Третья роль техника. У него должна быть возможность и заказать товар выбрав геолокацию и отправить так же указав геолокацию. соответственно при нажатии заказать на сервер отправляется запрос с геолокацией с пометкой покупатель и с отправкой то же но как продавец. Дополнительно в этой роли есть возможность открывать и закрывать грузовой люк дрона. Так же в проекте будет дронбокс где будет базироватся дрон до и после выполнения заказа по доставке. Соответственно там в дронбоксе платформа подъёмная. и у техника нужна дополнительно кнопка для выезда и убрания платформы.
1. Краткое резюме вашей логики:
Покупатель:
Может заказать только один товар.
Выбирает локацию посадки дрона.
Локация отправляется на сервер с пометкой "покупатель".
После заказа — отслеживание статуса (SSE).
После посадки — экран открытия грузового бокса.
Продавец:
Две страницы: товары и заказы.
Каждый заказ отправляется отдельно.
Открывает карточку заказа, вызывает дрона, указывает точку посадки.
Локация отправляется на сервер с пометкой "продавец".
Статусы: дрон вылетел, дрон прилетел.
После посадки — открытие грузового бокса, отправка дрона, отслеживание статуса.
После получения товара покупателем — уведомление и удаление заказа.
Техник:
Может заказывать и отправлять товар (как покупатель и продавец).
Может открывать/закрывать грузовой люк дрона.
Управляет платформой дронбокса (выезд/уборка).
2. Что уже реализовано (по структуре проекта):
Есть контроллеры и экраны для покупателя, продавца, заказов, профиля, карты, статусов, открытия бокса.
Есть модели для заказов, пользователей, полётов.
Есть репозитории и API-слои для заказов, полётов, авторизации.
Есть виджеты для карты, баннеров, категорий, продуктов.
Есть локализация, темы, утилиты.
3. Что нужно проверить и доработать:
Полная ли логика по ролям реализована (особенно для техника).
Корректно ли реализован выбор и отправка геолокации для всех ролей.
Реализовано ли открытие/закрытие грузового люка и управление платформой для техника.
Корректно ли реализованы статусы заказов и их обновление через SSE.
Удаляется ли заказ у продавца после получения товара покупателем.
Есть ли отдельные экраны/виджеты для всех нужных действий (карта, статусы, управление дроном/боксом/платформой).
Мой рабочий промт для доработки и поддержки проекта:
Ты — ассистент-разработчик Flutter-проекта доставки дронами. В проекте три роли: покупатель, продавец, техник.
Всегда анализируй, реализована ли логика для каждой роли согласно бизнес-описанию.
При каждом запросе пользователя:
Проверяй, реализована ли нужная бизнес-логика в коде.
Если не реализована — предлагай и реализуй изменения в коде (создавай/дополняй контроллеры, экраны, API, виджеты).
Следи за корректной работой с сервером (правильные endpoint'ы, SSE, статусы, отправка координат).
Учитывай особенности каждой роли (например, у техника — расширенные права по управлению дроном и платформой).
Следи за чистотой архитектуры, повторным использованием кода, локализацией, темами.
Если что-то не реализовано или реализовано не полностью — предлагай и реализуй доработки.
Всегда делай изменения в коде проекта, если это возможно
Я использую windows
globs: *.dart, *.yaml
alwaysApply: false
---

